<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>InstaResume Builder</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(to right, #e0f7fa, #ffe0f7);
      padding: 2rem;
    }
    .extra-box {
      margin-top: 1rem;
    }
    .template-option {
      padding: 0.5rem;
      border: 1px solid #ccc;
      border-radius: 0.25rem;
      cursor: pointer;
      text-align: center;
    }
    .template-option:hover {
      background-color: #f0f0f0;
    }
    .template-box {
      width: 100px;
      height: 50px;
      border-radius: 0.5rem;
      border: 2px solid #ddd;
    }
  </style>
</head>
<body>
  <div class="sticky top-0 bg-white shadow-md p-4 z-50 flex justify-between items-center">
    <h1 class="text-xl font-bold">InstaResume Builder</h1>
    <div class="space-x-2">
      <button id="generateSummaryBtn" class="bg-indigo-600 text-white px-3 py-1 rounded">Generate AI Summary</button>
      <button id="downloadBtn" class="bg-green-600 text-white px-3 py-1 rounded">Download PDF</button>
    </div>
  </div>

  <div class="max-w-4xl mx-auto mt-4 bg-white p-6 rounded shadow">
    <form id="resumeForm" class="space-y-4">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <input id="fullName" placeholder="Full Name" class="p-2 border rounded" required />
        <input id="email" placeholder="Email" class="p-2 border rounded" required />
        <input id="phone" placeholder="Phone Number" class="p-2 border rounded" required />
        <input id="linkedin" placeholder="LinkedIn URL" class="p-2 border rounded" />
        <input id="github" placeholder="GitHub URL" class="p-2 border rounded" />
        <input id="photo" type="file" accept="image/*" class="p-2 border rounded" />
      </div>

      <textarea id="summary" placeholder="Professional Summary (You can auto-generate too)" class="w-full p-2 border rounded" rows="3"></textarea>
      <textarea id="experience" placeholder="Work Experience" class="w-full p-2 border rounded" rows="3"></textarea>
      <textarea id="education" placeholder="Education" class="w-full p-2 border rounded" rows="3"></textarea>
      <textarea id="skills" placeholder="Skills (comma-separated)" class="w-full p-2 border rounded" rows="2"></textarea>
      <textarea id="languages" placeholder="Languages (comma-separated)" class="w-full p-2 border rounded" rows="2"></textarea>
      <textarea id="projects" placeholder="Projects" class="w-full p-2 border rounded" rows="2"></textarea>

      <div id="extraSections"></div>
      <button type="button" id="addExtraBtn" class="mt-2 bg-gray-200 px-4 py-1 rounded">+ Add Extra Section</button>

      <div class="mt-4">
        <button type="submit" class="bg-purple-600 text-white px-6 py-2 rounded">Generate Preview</button>
      </div>
    </form>

    <div class="mt-6">
      <h2 class="text-lg font-semibold mb-2">Choose Template Color</h2>
      <div id="templateChoices" class="grid grid-cols-5 gap-2">
        <div class="template-option" data-color="#fef3c7"><div class="template-box" style="background:#fef3c7"></div>Gold</div>
        <div class="template-option" data-color="#e0f2fe"><div class="template-box" style="background:#e0f2fe"></div>Blue</div>
        <div class="template-option" data-color="#ede9fe"><div class="template-box" style="background:#ede9fe"></div>Lavender</div>
        <div class="template-option" data-color="#d1fae5"><div class="template-box" style="background:#d1fae5"></div>Green</div>
        <div class="template-option" data-color="#fce7f3"><div class="template-box" style="background:#fce7f3"></div>Pink</div>
        <div class="template-option" data-color="#e5e7eb"><div class="template-box" style="background:#e5e7eb"></div>Gray</div>
        <div class="template-option" data-color="#fff7ed"><div class="template-box" style="background:#fff7ed"></div>Orange</div>
        <div class="template-option" data-color="#f0fdf4"><div class="template-box" style="background:#f0fdf4"></div>Mint</div>
        <div class="template-option" data-color="#f3f4f6"><div class="template-box" style="background:#f3f4f6"></div>Light Gray</div>
        <div class="template-option" data-color="#fef9c3"><div class="template-box" style="background:#fef9c3"></div>Lemon</div>
        <div class="template-option" data-color="None"><div class="template-box" style="background:#fbfbfb"></div>No-Colour</div>     
      </div>
    </div>

    <div id="preview" class="mt-8 p-6 rounded border"></div>
  </div>

  <script>
    const form = document.getElementById("resumeForm");
    const preview = document.getElementById("preview");
    const downloadBtn = document.getElementById("downloadBtn");
    const addExtraBtn = document.getElementById("addExtraBtn");
    const extraSections = document.getElementById("extraSections");
    const photoInput = document.getElementById("photo");
    const templateButtons = document.querySelectorAll(".template-option");
    let photoDataURL = "";
    let previewBg = "white";

    photoInput.addEventListener("change", () => {
      const file = photoInput.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = () => {
          photoDataURL = reader.result;
          renderPreview();
        };
        reader.readAsDataURL(file);
      }
    });

    templateButtons.forEach(btn => {
      btn.addEventListener("click", () => {
        previewBg = btn.dataset.color;
        renderPreview();
      });
    });

    function renderPreview() {
      const getValue = id => document.getElementById(id).value;
      const fullName = getValue("fullName");
      const email = getValue("email");
      const phone = getValue("phone");
      const linkedin = getValue("linkedin");
      const github = getValue("github");
      const summary = getValue("summary");
      const experience = getValue("experience").replace(/\n/g, "<br>");
      const education = getValue("education").replace(/\n/g, "<br>");
      const skills = getValue("skills");
      const languages = getValue("languages");
      const projects = getValue("projects").replace(/\n/g, "<br>");

      const links = [
        linkedin && `<a href="${linkedin}" target="_blank" class="underline text-blue-600">LinkedIn</a>`,
        github && `<a href="${github}" target="_blank" class="underline text-blue-600">GitHub</a>`
      ].filter(Boolean).join(" | ");

      const photoHTML = photoDataURL ? `<img src="${photoDataURL}" alt="Photo" class="w-24 h-24 rounded-full object-cover" />` : "";

      let extraHTML = "";
      document.querySelectorAll(".extra-box").forEach(box => {
        const head = box.querySelector(".extra-head").value;
        const info = box.querySelector(".extra-info").value.replace(/\n/g, "<br>");
        if (head && info) {
          extraHTML += `<h2 class="text-xl font-semibold mt-4">${head}</h2><p>${info}</p>`;
        }
      });
      const bgStyle = previewBg === "none" ? "white" : previewBg;

      const html = `
        <div class="space-y-4" style="background-color: ${previewBg}; padding: 1rem; border-radius: 0.5rem;">
          <div class="flex gap-4 items-center">${photoHTML}
            <div>
              <h1 class="text-2xl font-bold">${fullName}</h1>
              <p>${email} | ${phone}</p>
              <p>${links}</p>
            </div>
          </div>
          <hr>
          <h2 class="text-xl font-semibold">Summary</h2><p>${summary}</p>
          <h2 class="text-xl font-semibold">Experience</h2><p>${experience}</p>
          <h2 class="text-xl font-semibold">Education</h2><p>${education}</p>
          <h2 class="text-xl font-semibold">Skills</h2><p>${skills}</p>
          <h2 class="text-xl font-semibold">Languages</h2><p>${languages}</p>
          <h2 class="text-xl font-semibold">Projects</h2><p>${projects}</p>
          ${extraHTML}
        </div>`;

      preview.innerHTML = html;
    }

    form.addEventListener("submit", e => {
      e.preventDefault();
      renderPreview();
    });

    document.querySelectorAll("input, textarea").forEach(input => {
      input.addEventListener("input", renderPreview);
    });

    addExtraBtn.addEventListener("click", () => {
      const section = document.createElement("div");
      section.classList.add("extra-box");
      section.innerHTML = `
        <input placeholder="Section Heading" class="extra-head p-2 border rounded w-full mb-2"/>
        <textarea placeholder="Information" rows="2" class="extra-info p-2 border rounded w-full"></textarea>`;
      extraSections.appendChild(section);
    });

    downloadBtn.addEventListener("click", () => {
      const opt = {
        margin: 0.5,
        filename: 'resume.pdf',
        image: { type: 'jpeg', quality: 0.98 },
        html2canvas: { scale: 2 },
        jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }
      };
      html2pdf().set(opt).from(preview).save();
    });

    document.getElementById("generateSummaryBtn").addEventListener("click", () => {
      const exp = document.getElementById("experience").value;
      const edu = document.getElementById("education").value;
      const skill = document.getElementById("skills").value;
      const summaryText = `A motivated professional with experience in ${exp.split("\n")[0] || "various fields"}, strong academic background in ${edu.split("\n")[0] || "relevant domains"}, and skills including ${skill || "key technologies"}. Seeking impactful roles to grow and contribute.`;
      document.getElementById("summary").value = summaryText;
      renderPreview();
    });

    window.onload = renderPreview;
  </script>
</body>
</html>
